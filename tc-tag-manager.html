<link rel="import" href="../polymer/polymer.html">

<!--
### tc-google-analytics

`tc-tag-manager` is used for inserting the Google Tag Manager script into your 
page. This element should only be inserted into your app once. 
Use the `tc-tag-manager-behavior` for sending events and `virtualPageViews`.

### Sample usage

    <tc-tag-manager gtm-id="GTM-XXXXXX"></tc-tag-manager>

@element tc-tag-manager-analytics
@demo demo/tag-manager.html
-->

<dom-module id="tc-tag-manager">
  <script>
    Polymer({

      is: 'tc-tag-manager',

      properties: {
        /** The Tag Manager ID, starts with GTM-. This must be set */
        gtmId: {
          type: String
        }
      },

      ready: function() {
        if (!this.gtmId) {
          console.error('No GTM ID was defined, make sure to set it.');
          return;
        }

        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer',this.gtmId);
      }
    });
  </script>
</dom-module>